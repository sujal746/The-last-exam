import React, { useState, useEffect, useCallback, useMemo } from 'react';
import { Heart, Sparkles, Star, BookOpen, Clock, Gift, Send, Trophy, Coffee } from 'lucide-react';

const App = () => {
  const [isOpen, setIsOpen] = useState(false);
  const [hearts, setHearts] = useState([]);
  const [messageIndex, setMessageIndex] = useState(0);
  
  // Target Date: 28 Dec 2025 2:00 PM
  const targetDate = useMemo(() => new Date('2025-12-28T14:00:00'), []);
  
  const [timeLeft, setTimeLeft] = useState({
    days: 0, hours: 0, minutes: 0, seconds: 0, finished: false
  });

  const messages = [
    "You've worked so hard for this! üìö",
    "Your intelligence is only matched by your beauty. ‚ú®",
    "I believe in you more than anyone else in the world. ‚ù§Ô∏è",
    "Take a deep breath, you're going to be amazing! üå¨Ô∏è",
    "I'm already so proud of you, no matter what. üíç",
    "Your future is as bright as your smile! ‚òÄÔ∏è",
  ];

  // Timer Logic
  useEffect(() => {
    const timer = setInterval(() => {
      const now = new Date();
      const difference = targetDate.getTime() - now.getTime();

      if (difference <= 0) {
        setTimeLeft({ days: 0, hours: 0, minutes: 0, seconds: 0, finished: true });
        clearInterval(timer);
      } else {
        setTimeLeft({
          days: Math.floor(difference / (1000 * 60 * 60 * 24)),
          hours: Math.floor((difference / (1000 * 60 * 60)) % 24),
          minutes: Math.floor((difference / 1000 / 60) % 60),
          seconds: Math.floor((difference / 1000) % 60),
          finished: false
        });
      }
    }, 1000);

    return () => clearInterval(timer);
  }, [targetDate]);

  // Floating Hearts Logic
  const createHeart = useCallback(() => {
    const id = Date.now() + Math.random();
    const newHeart = {
      id,
      left: Math.random() * 90 + 5 + '%',
      size: Math.random() * 20 + 10 + 'px',
      duration: Math.random() * 3 + 4 + 's'
    };
    setHearts(prev => [...prev.slice(-15), newHeart]);
  }, []);

  useEffect(() => {
    if (isOpen) {
      const interval = setInterval(createHeart, 800);
      const msgInterval = setInterval(() => {
        setMessageIndex(prev => (prev + 1) % messages.length);
      }, 4500);
      return () => {
        clearInterval(interval);
        clearInterval(msgInterval);
      };
    }
  }, [isOpen, createHeart]);

  const toggleOpen = () => {
    setIsOpen(true);
    if (window.navigator.vibrate) window.navigator.vibrate(50);
  };

  return (
    <div className="min-h-screen bg-[#fff5f7] flex flex-col items-center justify-center p-4 relative overflow-hidden font-sans">
      
      {/* Animated Background Hearts */}
      {isOpen && hearts.map(heart => (
        <div
          key={heart.id}
          className="absolute bottom-0 text-pink-300 pointer-events-none"
          style={{
            left: heart.left,
            fontSize: heart.size,
            animation: `floatUp ${heart.duration} ease-in forwards`,
            opacity: 0.5
          }}
        >
          ‚ù§Ô∏è
        </div>
      ))}

      <main className="z-10 w-full max-w-md">
        {!isOpen ? (
          /* Locked State */
          <div className="bg-white rounded-[2.5rem] shadow-2xl p-10 text-center border-b-8 border-pink-100 transform transition-all hover:scale-[1.02]">
            <div className="relative inline-block mb-6">
              <div className="bg-pink-100 w-24 h-24 rounded-full flex items-center justify-center animate-pulse">
                <Gift size={48} className="text-pink-500" />
              </div>
              <Heart className="absolute -top-2 -right-2 text-pink-400 fill-pink-400 animate-bounce" size={24} />
            </div>
            
            <h1 className="text-3xl font-bold text-gray-800 mb-3">For My Future Wife... üíç</h1>
            <p className="text-gray-500 mb-10 text-lg">
              I know you're busy preparing for the 28th. I built something special to cheer you on.
            </p>
            
            <button
              onClick={toggleOpen}
              className="w-full bg-gradient-to-r from-pink-400 to-rose-400 hover:from-pink-500 hover:to-rose-500 text-white font-bold py-5 rounded-2xl shadow-xl transform active:scale-95 transition-all flex items-center justify-center gap-3 text-lg"
            >
              Unlock Your Encouragement <Send size={22} />
            </button>
          </div>
        ) : (
          /* Surprise Revealed State */
          <div className="space-y-6 animate-in fade-in zoom-in duration-500">
            
            {/* Countdown Section */}
            <div className="bg-white/80 backdrop-blur-md rounded-3xl p-6 shadow-lg border border-pink-100 text-center">
              <div className="flex items-center justify-center gap-2 mb-4 text-pink-500 font-bold uppercase tracking-widest text-xs">
                <Clock size={14} /> 
                {timeLeft.finished ? "IT'S TIME!" : "Countdown to Success"}
              </div>
              
              {!timeLeft.finished ? (
                <div className="flex justify-center gap-3">
                  {[
                    { label: 'Days', val: timeLeft.days },
                    { label: 'Hrs', val: timeLeft.hours },
                    { label: 'Min', val: timeLeft.minutes },
                    { label: 'Sec', val: timeLeft.seconds }
                  ].map((unit, i) => (
                    <div key={i} className="flex flex-col items-center bg-pink-50 px-3 py-2 rounded-xl min-w-[65px]">
                      <span className="text-2xl font-black text-pink-600">{unit.val.toString().padStart(2, '0')}</span>
                      <span className="text-[10px] text-pink-400 font-bold">{unit.label}</span>
                    </div>
                  ))}
                </div>
              ) : (
                <div className="bg-green-50 text-green-600 p-4 rounded-2xl font-bold flex items-center justify-center gap-3">
                  <Trophy size={24} /> GO CRUSH THAT EXAM! <Trophy size={24} />
                </div>
              )}
            </div>

            {/* Main Content Card */}
            <div className="bg-white rounded-[2.5rem] shadow-2xl p-8 border-t-[12px] border-pink-400 relative overflow-hidden">
               <div className="absolute top-0 right-0 p-4 opacity-10">
                  <Sparkles size={80} className="text-pink-600" />
               </div>

              <div className="text-center">
                <div className="bg-pink-100 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-6 transform -rotate-6">
                  <Coffee className="text-pink-500" size={32} />
                </div>
                
                <h2 className="text-3xl font-black text-gray-900 mb-4 tracking-tight">You've Got This! üåü</h2>
                
                <div className="min-h-[100px] flex items-center justify-center px-4">
                   <p className="text-xl text-pink-600 font-serif italic transition-all duration-700">
                    "{messages[messageIndex]}"
                  </p>
                </div>

                <div className="mt-8 space-y-4 text-gray-600 leading-relaxed">
                  <p>
                    I know the pressure is on, but you are the strongest and smartest person I know. Just take it one question at a time.
                  </p>
                  <p className="font-bold text-gray-800 text-lg">
                    I'm already planning our "Exam is Over" celebration! ü•Ç
                  </p>
                </div>
              </div>
            </div>

            {/* Tiny Motivation Badge */}
            <div className="bg-gradient-to-br from-pink-500 to-rose-600 rounded-3xl p-6 text-white shadow-xl flex items-center gap-5">
              <div className="bg-white/20 p-4 rounded-2xl backdrop-blur-sm">
                <Heart fill="white" size={28} className="animate-pulse" />
              </div>
              <div className="flex-1">
                <p className="text-xs font-bold opacity-80 uppercase tracking-tighter mb-1 text-pink-100">Forever Your Biggest Fan</p>
                <p className="text-xl font-bold leading-tight">Love you more than words can say. ‚ù§Ô∏è</p>
              </div>
            </div>

            <button 
              onClick={() => setIsOpen(false)}
              className="text-pink-400 hover:text-pink-600 text-sm font-bold w-full text-center transition-colors"
            >
              Back to Cover
            </button>
          </div>
        )}
      </main>

      <style dangerouslySetInnerHTML={{ __html: `
        @keyframes floatUp {
          0% { transform: translateY(0) scale(1) rotate(0deg); opacity: 0; }
          20% { opacity: 0.6; }
          100% { transform: translateY(-100vh) scale(1.8) rotate(20deg); opacity: 0; }
        }
        .animate-in { animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes slideUp {
          from { opacity: 0; transform: translateY(40px); }
          to { opacity: 1; transform: translateY(0); }
        }
      `}} />
    </div>
  );
};

export default App;

